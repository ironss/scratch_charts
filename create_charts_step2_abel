
SQLITE3=/usr/bin/sqlite3

addlayer () 
{

echo "$1 $2"

(
cat <<EOF
BEGIN TRANSACTION;
EOF

$SQLITE3 out/$1/OruxMapsImages.db .d | 
grep "INSERT INTO \"tiles\" VALUES([[:digit:]]\+,[[:digit:]]\+"

cat <<EOF
COMMIT;
EOF

) | sed -e "s/INSERT/INSERT OR REPLACE/" | $SQLITE3 Abel/OruxMapsImages.db

}



mkdir -p Abel
rm -f Abel/OruxMapsImages.db

(cat <<EOF
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE tiles (x int, y int, z int, image blob, PRIMARY KEY (x,y,z));
COMMIT;
EOF
) | $SQLITE3 Abel/OruxMapsImages.db


addlayer NZ61
addlayer NZ614
addlayer NZ614_1
addlayer NZ614_2
addlayer NZ6142_1
addlayer NZ6142_2
addlayer NZ6143
addlayer NZ6144
addlayer NZ6144_1

(
cat <<EOF
BEGIN TRANSACTION;
CREATE TABLE android_metadata (locale TEXT);
INSERT INTO "android_metadata" VALUES('en_NZ');
CREATE INDEX IND on tiles (x,y,z);
COMMIT;
EOF

) | $SQLITE3 Abel/OruxMapsImages.db

